<!DOCTYPE html>
<html>
<head>
    <title>Test Bassline Export</title>
</head>
<body>
    <h1>Test Bassline Export</h1>
    <button id="exportBtn">Export Root Group</button>
    <div id="result"></div>
    
    <script>
        document.getElementById('exportBtn').addEventListener('click', async () => {
            const formData = new FormData();
            formData.append('groupId', 'root');
            formData.append('includeValues', 'true');
            formData.append('exportAll', 'false');
            
            try {
                const response = await fetch('http://localhost:5173/api/bassline/export', {
                    method: 'POST',
                    body: formData
                });
                
                const data = await response.json();
                
                if (data.success) {
                    // Create download
                    const blob = new Blob([data.bassline], { type: 'application/json' });
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = data.filename || 'export.bassline.json';
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);
                    
                    document.getElementById('result').innerText = 'Export successful! File downloaded.';
                } else {
                    document.getElementById('result').innerText = 'Export failed: ' + (data.error || 'Unknown error');
                }
            } catch (error) {
                document.getElementById('result').innerText = 'Error: ' + error.message;
            }
        });
    </script>
</body>
</html>